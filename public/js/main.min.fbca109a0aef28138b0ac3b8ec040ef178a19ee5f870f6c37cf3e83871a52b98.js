(function(){"use strict";const t=document.getElementById("progressBar");let f=!1;function p(){if(!t)return;const n=document.documentElement.scrollHeight-window.innerHeight,s=Math.max(0,Math.min(window.scrollY,n));let e;n<=0?e=100:s<=1?e=0:e=s/n*100,e=Math.max(0,Math.min(100,e)),!f||e<=0||e>=100?(t.style.transition="none",f=!0):t.style.transition="",t.style.width=`${e}%`,e>0?t.classList.add("active"):t.classList.remove("active")}function y(){if(!t)return;t.style.transition="none",t.style.width="0%"}const a=document.querySelector(".site-nav"),n=document.querySelector(".nav-toggle"),e=document.querySelector(".mobile-menu");let u=window.scrollY,r=!1;function h(){const t=window.scrollY;t>10?a.classList.add("nav-scrolled"):a.classList.remove("nav-scrolled"),e?.classList.contains("active")||(t>u&&t>200?a.classList.add("nav-hidden"):a.classList.remove("nav-hidden")),u=t,r=!1}function C(){r||(requestAnimationFrame(()=>{h(),p(),_()}),r=!0)}let o=[],i=null,c=null;function l(){const t=e.classList.contains("active");n.classList.toggle("active"),e.classList.toggle("active"),document.body.classList.toggle("no-scroll"),n.setAttribute("aria-expanded",!t),e.setAttribute("aria-hidden",t),t?n.focus():(o=e.querySelectorAll('a, button, [tabindex]:not([tabindex="-1"])'),o.length>0&&(i=o[0],c=o[o.length-1],i.focus()))}function v(t){if(!e.classList.contains("active"))return;t.key==="Tab"&&(t.shiftKey?document.activeElement===i&&(t.preventDefault(),c.focus()):document.activeElement===c&&(t.preventDefault(),i.focus()))}n&&e&&(n.addEventListener("click",l),e.querySelectorAll("a").forEach(t=>{t.addEventListener("click",()=>{e.classList.contains("active")&&l()})}),document.addEventListener("keydown",t=>{t.key==="Escape"&&e.classList.contains("active")&&l(),v(t)}));const g={root:null,rootMargin:"50px 0px -10% 0px",threshold:0},d=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("visible"),d.unobserve(e.target))})},g);function b(){const e=window.innerHeight;document.querySelectorAll(".article-content").forEach(t=>{t.querySelectorAll("p, h2, h3, blockquote, figure, ul, ol, hr, .section-break, .toc, aside").forEach((t,n)=>{const s=t.getBoundingClientRect();s.top>e*.8&&(t.classList.add("animate-on-scroll"),t.style.animationDelay=`${n%10*.05}s`,d.observe(t))})}),document.querySelectorAll(".article-card, .grid-card, .related-card").forEach((t,n)=>{const s=t.getBoundingClientRect();s.top>e*.8&&(t.classList.add("animate-on-scroll"),t.style.animationDelay=`${n%6*.1}s`,d.observe(t))})}function j(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if(t==="#")return;const n=document.querySelector(t);n&&(e.preventDefault(),n.scrollIntoView({behavior:"smooth",block:"start"}))})})}const s=document.getElementById("backToTop");function _(){if(!s)return;window.scrollY>400?s.classList.add("visible"):s.classList.remove("visible")}function w(){if(!s)return;s.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}function O(){const e=document.getElementById("themeToggle"),n=localStorage.getItem("theme"),s=window.matchMedia("(prefers-color-scheme: dark)");function t(t){t==="dark"?(document.body.classList.add("dark-mode"),document.body.classList.remove("light-mode"),e&&e.setAttribute("aria-label","Switch to light mode")):(document.body.classList.add("light-mode"),document.body.classList.remove("dark-mode"),e&&e.setAttribute("aria-label","Switch to dark mode")),localStorage.setItem("theme",t)}n?t(n):s.matches&&t("dark"),e&&e.addEventListener("click",()=>{const e=document.body.classList.contains("dark-mode");t(e?"light":"dark")})}function x(){const n=document.getElementById("searchInput"),e=document.getElementById("searchResults");if(!n||!e)return;let t=null,s=null;async function i(){try{const e=await fetch("/index.json");if(!e.ok)throw new Error(`HTTP ${e.status}`);s=await e.json(),t=s}catch(t){console.error("Failed to load search index:",t),e.innerHTML='<p class="search-no-results">Search is temporarily unavailable. Please try again later.</p>'}}function a(n){if(!t||!n.trim()){e.innerHTML="";return}const s=n.toLowerCase().split(/\s+/),i=t.filter(e=>{const t=(e.title+" "+e.content+" "+(e.tags||[]).join(" ")).toLowerCase();return s.every(e=>t.includes(e))}).slice(0,10);if(i.length===0){e.innerHTML='<p class="search-no-results">No results found</p>';return}e.innerHTML=i.map(e=>`
                <li class="search-result-item">
                    <a href="${e.permalink}" class="search-result-link">
                        <h3 class="search-result-title">${o(e.title,s)}</h3>
                        <p class="search-result-excerpt">${o(l(e.content,150),s)}</p>
                    </a>
                </li>
            `).join("")}function r(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function o(e,t){let n=r(e);return t.forEach(e=>{const t=new RegExp(`(${c(e)})`,"gi");n=n.replace(t,"<mark>$1</mark>")}),n}function c(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l(e,t){return e.length<=t?e:e.substr(0,t).replace(/\s+\S*$/,"")+"..."}n.addEventListener("input",e=>{a(e.target.value)}),n.addEventListener("focus",()=>{t||i()})}function m(){y(),window.addEventListener("scroll",C,{passive:!0}),window.addEventListener("load",()=>{p(),h()}),b(),j(),w(),x(),O()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m()})()