(function(){"use strict";const u=document.getElementById("progressBar");function r(){if(!u)return;const t=window.scrollY,e=document.documentElement.scrollHeight-window.innerHeight,n=e>0?t/e*100:0;u.style.width=`${Math.min(n,100)}%`}const n=document.querySelector(".site-nav"),s=document.querySelector(".nav-toggle"),e=document.querySelector(".mobile-menu");let c=window.scrollY,o=!1;function l(){const t=window.scrollY;t>10?n.classList.add("nav-scrolled"):n.classList.remove("nav-scrolled"),e?.classList.contains("active")||(t>c&&t>200?n.classList.add("nav-hidden"):n.classList.remove("nav-hidden")),c=t,o=!1}function j(){o||(requestAnimationFrame(()=>{l(),r(),p()}),o=!0)}function i(){const t=e.classList.contains("active");s.classList.toggle("active"),e.classList.toggle("active"),document.body.classList.toggle("no-scroll"),s.setAttribute("aria-expanded",!t)}s&&e&&(s.addEventListener("click",i),e.querySelectorAll("a").forEach(t=>{t.addEventListener("click",()=>{e.classList.contains("active")&&i()})}),document.addEventListener("keydown",t=>{t.key==="Escape"&&e.classList.contains("active")&&i()}));const h={root:null,rootMargin:"50px 0px -10% 0px",threshold:0},a=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("visible"),a.unobserve(e.target))})},h);function f(){const e=window.innerHeight;document.querySelectorAll(".article-content").forEach(t=>{t.querySelectorAll("p, h2, h3, blockquote, figure, ul, ol, hr, .section-break, .toc, aside").forEach((t,n)=>{const s=t.getBoundingClientRect();s.top>e*.8&&(t.classList.add("animate-on-scroll"),t.style.animationDelay=`${n%10*.05}s`,a.observe(t))})}),document.querySelectorAll(".article-card, .grid-card, .related-card").forEach((t,n)=>{const s=t.getBoundingClientRect();s.top>e*.8&&(t.classList.add("animate-on-scroll"),t.style.animationDelay=`${n%6*.1}s`,a.observe(t))})}function m(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if(t==="#")return;const n=document.querySelector(t);n&&(e.preventDefault(),n.scrollIntoView({behavior:"smooth",block:"start"}))})})}const t=document.getElementById("backToTop");function p(){if(!t)return;window.scrollY>400?t.classList.add("visible"):t.classList.remove("visible")}function g(){if(!t)return;t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}function v(){const e=document.getElementById("themeToggle"),n=localStorage.getItem("theme"),s=window.matchMedia("(prefers-color-scheme: dark)");function t(t){t==="dark"?(document.body.classList.add("dark-mode"),document.body.classList.remove("light-mode"),e&&e.setAttribute("aria-label","Switch to light mode")):(document.body.classList.add("light-mode"),document.body.classList.remove("dark-mode"),e&&e.setAttribute("aria-label","Switch to dark mode")),localStorage.setItem("theme",t)}n?t(n):s.matches&&t("dark"),e&&e.addEventListener("click",()=>{const e=document.body.classList.contains("dark-mode");t(e?"light":"dark")})}function b(){const n=document.getElementById("searchInput"),e=document.getElementById("searchResults");if(!n||!e)return;let t=null,s=null;async function i(){try{const e=await fetch("/index.json");s=await e.json(),t=s}catch(e){console.error("Failed to load search index:",e)}}function a(n){if(!t||!n.trim()){e.innerHTML="";return}const s=n.toLowerCase().split(/\s+/),i=t.filter(e=>{const t=(e.title+" "+e.content+" "+(e.tags||[]).join(" ")).toLowerCase();return s.every(e=>t.includes(e))}).slice(0,10);if(i.length===0){e.innerHTML='<p class="search-no-results">No results found</p>';return}e.innerHTML=i.map(e=>`
                <li class="search-result-item">
                    <a href="${e.permalink}" class="search-result-link">
                        <h3 class="search-result-title">${o(e.title,s)}</h3>
                        <p class="search-result-excerpt">${o(c(e.content,150),s)}</p>
                    </a>
                </li>
            `).join("")}function o(e,t){let n=e;return t.forEach(e=>{const t=new RegExp(`(${r(e)})`,"gi");n=n.replace(t,"<mark>$1</mark>")}),n}function r(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function c(e,t){return e.length<=t?e:e.substr(0,t).replace(/\s+\S*$/,"")+"..."}n.addEventListener("input",e=>{a(e.target.value)}),n.addEventListener("focus",()=>{t||i()})}function d(){window.addEventListener("scroll",j,{passive:!0}),window.addEventListener("load",()=>{r(),l()}),f(),m(),g(),b(),v()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):d()})()