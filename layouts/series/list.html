{{ define "main" }}

{{/* Get series metadata from data file */}}
{{ $seriesData := index .Site.Data.series .Title }}

{{/* Page Header */}}
<header class="page-header series-header">
    <div class="series-badge">Series</div>
    <h1>{{ .Title }}</h1>
    {{ with $seriesData }}
        {{ with .description }}
        <p class="series-description">{{ . }}</p>
        {{ end }}
    {{ else }}
        {{ with .Description }}
        <p class="series-description">{{ . }}</p>
        {{ end }}
    {{ end }}
    <p class="series-count">{{ len .Pages }} {{ if eq (len .Pages) 1 }}part{{ else }}parts{{ end }}</p>
</header>

{{/* Series Articles - ordered by series_weight */}}
<div class="article-list series-list">
    {{ $pages := .Pages.ByParam "series_weight" }}

    {{ range $index, $page := $pages }}
    <a href="{{ .Permalink }}" class="article-card series-card">

        <div class="series-part-indicator">
            <span class="part-number">Part {{ default (add $index 1) .Params.series_weight }}</span>
            <span class="part-total">of {{ len $pages }}</span>
        </div>

        {{/* Title */}}
        <h2 class="article-card-title">{{ .Title }}</h2>

        {{/* Excerpt */}}
        {{ with .Description | default .Summary }}
        <p class="article-card-excerpt">{{ . | plainify | truncate 180 }}</p>
        {{ end }}

        {{/* Meta */}}
        <p class="article-card-meta">
            {{ .Date.Format "2 January 2006" }}
            {{ with .Params.author }} · {{ . }}{{ end }}
            · {{ .ReadingTime }} min read
        </p>

    </a>
    {{ end }}
</div>

{{ end }}
